{% extends 'base2.html.twig' %}

{% block title %}Todo Project
{% endblock %}

{% block body %}
	<div class="table-data__tool">
		<div class="table-data__tool-right">
			<button class="au-btn au-btn-icon au-btn--green au-btn--small" data-toggle="modal" data-target="#myModal">
				<i class="zmdi zmdi-plus"></i>add item</button>
			<!-- The Modal -->
			<div class="modal" id="myModal">
				<div class="modal-dialog">
					<div class="modal-content">
						<!-- Modal Header -->
						<div class="modal-header">
							<h4 class="modal-title">Create Todo Task</h4>
						</div>
						<!-- Modal body -->
						<form action="{{path('createTodo')}}" class="modal-body" method="POST">
							<div class="form-group ">
								<label for="name" class="font-weight-bold">Name</label>
								<input type="text" class="form-control" id="name" name="name" required>
							</div>
							<div class="form-group">
								<label for="des" class="font-weight-bold">Description</label>
								<input type="text" class="form-control" id="des" name="des" required>
							</div>
							<br>
							<!-- Modal footer -->
							<div class="modal-footer">
								<button type="submit" class="btn btn-primary">Submit</button>
							</div>
						</form>
					</div>
				</div>
			</div>
		</div>
	</div>
	</div>
	<div class="table-responsive table-responsive-data2">
		<table class="table table-data2">
			<thead>
				<tr>
					<th onClick="orderColumn('name','<?php echo $nameNextOrder; ?>')">name</th>
					<th onClick="orderColumn('description','<?php echo $descriptionNextOrder; ?>')">description</th>
					<th onClick="orderColumn('createDate','<?php echo $createDateNextOrder; ?>')">creation date</th>
					<th>status</th>
					<th></th>
				</tr>
			</thead>
			<tbody>
				{% for item in list %}
				<tr class="tr-shadow">
					{% if item.status == 1 %}
					<td class="font-weight-bold">
						<del>{{item.name}}</del>
					</td>
					{% endif %}
					{% if item.status == 0 %}
					<td class="font-weight-bold">
						{{item.name}}
					</td>
					{% endif %}
					<td>{{item.description}}
					</td>
					<td>{{item.createDate|date('d-m-Y')}}</td>
					<td>{{item.status ? '<span class="badge badge-success">Completed</span>': '<span
							class="badge badge-danger">Not
							Completed</span>'}}</td>
					<td>
						<div class="table-data-feature">
							{% if item.status == 0 %}
							<button class="btn btn-success mr-1" data-toggle="tooltip" data-placement="top" title="Do"
								onclick="location.href='/list/do/{{item.id}}'">
								<i class="fa-solid fa-check"></i>
							</button>
							{% endif %}
							{% if item.status == 1 %}
							<button class="btn btn-warning mr-1" data-toggle="tooltip" data-placement="top" title="Undo"
								onclick="location.href='/list/undo/{{item.id}}'">
								<i class="fa-solid fa-xmark"></i>
							</button>
							{% endif %}
							<button class="btn btn-primary mr-1" data-toggle="tooltip" data-placement="top" title="Edit"
								onclick="location.href='/list/update/{{item.id}}'">
								<i class="zmdi zmdi-edit"></i>
							</button>
							<a class="btn btn-danger btn-del" href="list/delete/{{item.id}}" data-toggle="tooltip" data-placement="top" title="Delete">
								<i class="zmdi zmdi-delete"></i>
								<input id="alertDel" class="ab" type="hidden" value="Task {{item.name}} has been deleted">
							</a>
						</div>
					</td>
					</td>
				</tr>
				<tr class="spacer"></tr>
				{% endfor %}
			</tbody>
		</table>
	</div>
{% endblock %}

{% block script %}
<script>
	$('.btn-del').on('click',function(e) {
		e.preventDefault();
		const href = $(this).attr('href');
		Swal.fire({
			title: 'Are you sure?',
			text: "You won't be able to revert this!",
			icon: 'warning',
			showCancelButton: true,
			confirmButtonColor: '#3085d6',
			cancelButtonColor: '#d33',
			confirmButtonText: 'Yes, delete it!'
			}).then((result) => {
			if (result.isConfirmed) {
				document.location.href = href;
				Swal.fire(
				'Deleted!',
				"Your task has been deleted",
				'success'
				)
			}
			else{
				Swal.fire(
                "Cancelled",
                "Your action has been cancelled",
                "error"
            	)
			}
		})
	})
	function orderColumn(column_name,column_order) {
		$.ajax({
			url: "order-column.php",
			data:'orderby='+column_name+'&order='+column_order,
			type: "POST",
			success: function(data){	
				$('#demo-order-list').html(data);
			}
		});
	} 	

	document.getElementById('myModal').onsubmit = function(){
		Swal.fire({
        position: "top-right",
        icon: "success",
        title: "Your task has been created",
        showConfirmButton: false,
        timer: 2000
    });
	}
</script>
{% endblock %}